\documentclass[printmode]{mgr}

\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}

\usepackage{graphicx}
\usepackage{caption}
\usepackage{subcaption}
\usepackage{psfrag}
\graphicspath{{./images/}}

\usepackage{amsmath}
\usepackage{amsfonts}

\usepackage{supertabular}
\usepackage{array}
\usepackage{tabularx}
\usepackage{hhline}

\usepackage{hyperref}

\title{Embedded Linux \\ build systems}
\engtitle{Systemy implementacji \\ wbudowanego Linuxa}
\author{Cezary Dynak}
\supervisor{dr Witold Paluszy≈Ñski}

\field{Automatyka i~Robotyka (AIR)}
\specialisation{Embedded Robotics (AER)}

\begin{document}
\bibliographystyle{plabbrv}

\maketitle
\dedication{6cm}{To my wife and son}

\tableofcontents

\chapter{Introduction}
\section{Goals of the project}
The goal of this project is to explore, compare and extend embedded Linux build systems. \cite{web:bis-org-pl}
\begin{figure}[htbp]
  \centering
    \includegraphics[width=0.5\textwidth]{Tux.png}
  \caption{Penguin Tux - Linux mascot}
  \label{fig:panel-dotykowy}
\end{figure}

\chapter{Literature review}
\label{chapter:literature-review}

There are two important issues, that I faced while making literature review: firstly what kind of materials should I analyze and secondly how to extend my searches, to get a full overview of current state of knowledge on this topic.  \\

First issue was very clear in previous (XX) century - literature review was about analyzing two kind of printed materials: longer ones which were just specialist books and shorter ones which were peed reviewed articles in scientific or industry magazines.
Right now they are also available and easy accessible in electronic form and still they are most reliable sources for literature review, but not every IT engineer is using it.
Open Source Software and Open Source Hardware movement, beside creating loot of tools, also created a lot of written knowledge materials, but they are distributed in very different ways: project documentation, presentations, tutorials, source code comments, README s, How To s, FAQs, wiki's, finally blog and forum posts, but also in other forms.
Hopefully, because they are all available via Internet, there exist one unified way to reference them: URL (Unified Resource Locator) also known as web address or link. Because of that, this and most of other bibliographies are filled with URLs, not ISBN s. I tried to divide all of those into groups as clearly as possible.

Second thing is how to be sure that I covered everything, at least by mentioning. Search results are personalized, both by searchers behavior who is choosing keywords and also Search Engine Optimization. Nobody could tell, that this is complete, but sources are cross referenced, so after some research, the loop closed. Most important factor for choosing materials is their universality and chance that they will be not so fast outdated.

\section{elinux.org}

The Embedded Linux Developer wiki elinux.org is undeniably the most extensive source of knowledge about all aspects of Embedded Linux.
In this form it was possible to consolidate powerful community which extend its contests.
From one side it is greatly filled with a lot of technical details and still extended, but from the other the content is not always universal and some pages are not maintained.\\

The elinux.org domain was registered on 1999-11-04 (\url{https://who.is/whois/elinux.org}) and used by a Linux specialist Tim Riker (\url{http://rikers.org}) just as a placeholder (\url{https://web.archive.org/web/20010721180347/elinux.org}).
About 2003 the Embedded Linux wiki was initiated here using MoinMoin framework (\url{https://web.archive.org/web/20030220110526/http://www.elinux.org:80/wiki/}).
In 2007 it was moved into Media Wiki engine, in which it still exists today.
On the top level, its contents are divided into two main parts: "Development Portals" about various aspects of embedded Linux and "Hardware Pages" for different development boards.
The most relevant page for this thesis is \url{http://elinux.org/Build_Systems}\\

Currently it is maintained by the Core Embedded Linux Project which belongs to Linux foundation (\url{https://www.linuxfoundation.org/projects/core-embedded-linux}).
CELP is also coordinator of other important Embedded Linux activities.

\section{wikipedia.org / dbpedia.org}

Although Wikipedia allow anyone to edit articles it is the largest and most popular general reference work on the Internet.
The most important thing from my point of view, is that it redirects and groups abstract entities on the high level.
It's also possible to process Wikipedia contents and the DBpedia is one of the projects, that aims to transform it into semantic knowledge.
The table below summarizes pages that are most relevant for this work.

\begin{center}
  \begin{tabular}{| l | l |}
    \hline
    \url{https://en.wikipedia.org/wiki/Category:Embedded_Linux} & \\
    \hline
    \url{https://en.wikipedia.org/wiki/Category:Software_related_to_embedded_Linux} & \\
    \hline
    \url{https://en.wikipedia.org/wiki/Category:Embedded_Linux_distributions} & \\
    \hline
    \url{} & \\
    \hline
    \url{https://en.wikipedia.org/wiki/Linux_on_embedded_systems} & \\
    \hline
    \url{https://en.wikipedia.org/wiki/List_of_build_automation_software} & \\
    \hline
    \url{https://en.wikipedia.org/wiki/Cross_compiler} & \\
    \hline
    \url{} & \\
    \hline
    \url{https://en.wikipedia.org/wiki/OpenEmbedded} & \\
    \hline
    \url{} & \\
    \hline
    \url{https://en.wikipedia.org/wiki/Microprocessor_development_board} & \\
    \hline
    \url{} & \\
    \hline
    \url{https://en.wikipedia.org/wiki/Linux_Standard_Base} & \\
    \hline
    \url{https://en.wikipedia.org/wiki/Single_UNIX_Specification} & \\
    \hline
    \url{https://en.wikipedia.org/wiki/POSIX} & \\
    \hline
    \url{} & \\
    \hline
    \url{} & \\
    \hline
    \url{} & \\
    \hline
    \url{} & \\
    \hline
    \url{} & \\
    \hline
  \end{tabular}
\end{center}

\url{https://en.wikipedia.org/wiki/Comparison_of_single-board_computers}
\url{https://en.wikipedia.org/wiki/Ancient_UNIX}

https://www.opengroup.org/testing/downloads.html
https://www.opengroup.org/testing/linux-test/
https://wiki.linuxfoundation.org/en/Testing

posixtestsuite-1.5.2.tar.gz
https://sourceforge.net/projects/posixtest/
http://posixtest.sourceforge.net/
https://sourceforge.net/p/posixtest/mailman/posixtest-discuss/

\url{https://github.com/search?utf8=\%E2\%9C\%93&q=posixtest}
\url{https://github.com/juj/posixtestsuite}

https://github.com/kripken/emscripten
http://kripken.github.io/emscripten-site/

\url{https://s3.amazonaws.com/programista/Programista_40_ECMAScript6_all.pdf}
\url{https://ssearch.oreilly.com/?q=embedded&x=0&y=0}

During this project, I worked on extending enumerated categories and writing first version of article \url{https://en.wikipedia.org/wiki/Embedded_Linux_build_systems}.

\begin{itemize}
  \item \url{http://dbpedia.org/page/Category:Embedded_Linux}
  \item \url{http://dbpedia.org/page/Linux_on_embedded_systems}
\end{itemize}

\section{Marcin Bis publications}

In Poland, the most extensive source of written knowledge is provided by Mr Marcin Bis.
He has published two books so far: "Linux in embedded systems" (pol. "Linux w systemach embedded") in 2011 and "Linux in i.MX 6 series systems" (pol. "Linux w systemach i.MX6 series") in 2015.
The company BIS-LINUX.COM is also offering various paid workshops and consultations.

\section{Conferences and workshops}

One part of it are public, like Embedded Linux Conferences organized by CELP, from which slides and recordings are available on elinux.org:

\begin{itemize}
  \item \url{http://elinux.org/Category:ELC} (Embedded Linux Conference)
  \item \url{http://elinux.org/Category:ELCE} (Embedded Linux Conference Europe)
\end{itemize}

Embedded Linux issues connected to build systems are also present on Linux Sessions (\url{sesja.linuksowa.pl}) organized each year by Academic IT Association (http://asi.wroclaw.pl) each year on Wroclaw university of Technology. \\

Another ones are organized by private companies and they are mostly consisting of interactive workshop sessions. The paid ones are organized i.e. by Marcin Bis (http://www.bis-linux.com/szkolenia). There are also free of charge workshops i.e. ones organized by EBV in 2016, where I participated.

\section{Search results}

\subsection{WrUST search}

\subsection{scholar.google.com}

\url{https://scholar.google.pl/scholar?q="embedded+linux+build+systems"}

The phrase "embedded linux build systems" gives only 2 results (as for 2017--). First of them is presentation "Embedded Linux system development" by Thomas Petazzoni from year 2004. It describes only Open Embedded which is currently included as a part of Yocto Project. Second one is book "Mastering embedded Linux programming" by Chris Simmonds from year 2015. It differentiates only Buildroot and Yocto Project. \\

\url{https://scholar.google.pl/scholar?q="embedded+linux+build+system"}

The phrase "embedded linux build system" gives 24 results (as for 2017--). Most of recent works enumerates Buildroot, Yocto Project, OpenWrt without comparison between them. Materials prior to 2010 are mostly using therm "embedded linux distribution", rather than "embedded linux build system".

\url{https://www.researchgate.net/profile/Angel_Varela_Vaca/publication/296678719_Embedded_Kernel_customization_to_optimize_performance_and_power_management_An_application_to_IoT/links/56d80d5a08aee1aa5f76df8f.pdf}

\subsection{google.com}

\url{https://www.google.com/?q=embedded+linux+build+systems} (opera + incognito + VPN USA)

\subsection{duckduckgo.com}

\section{official documentation}

The most valuable source of technical information is and should be always official documentation.

\chapter{Development boards}
\label{chapter:development-boards}

From the beginning of embedded systems history, microprocessor development boards were just a training resource for engineers.
Usually they were designed and produced by companies that have created certain chip and costs a lot of money, that it was not affordable for hobbyists or students.
In recent years this state was changed by a few factors:
\begin{itemize}
  \item the spread of ARM architecture micro-controllers with efficiency comparable to personal computers (1GHz),
  \item creating development boards by community as open hardware, that led to cost reduction,
  \item adding peripherals specific not for embedded systems but for personal computers.
\end{itemize}
This led to discovering totally new use cases for development boards which explode due to widespread success of Raspberry Pi platform. \\
I've selected some of most popular devices with ARM to compare them, but also include my personal laptop computer as a reference for x86 architecture. Because of very low popularity, I don't investigate other chips with SPARC or Power Architecture. \\

At minimum, each platform have:
\begin{itemize}
  \item powered by low voltage (5V-24V)
  \item at least one UART, for serial console
  \item at least one Ethernet port, 100 MB/s or higher
  \item at least one USB port, 2.0 or higher
  \item SD card interface
\end{itemize}

\renewcommand{\arraystretch}{2}
\begin{table}
  \begin{tabular}{| p{2cm} | p{2cm} | p{2cm} | p{2cm} | p{2cm} | p{2cm} | p{2cm} |}
    \hline
    name & Raspberry Pi 2 Model B & BeagleBone Black & PandaBoard & Wandboard Quad & Grinn liteboard & Asus Eee PC 1215n \\
    \hline
    release date & February 2015 & April 2013 & October 2010 & February 2013 & August 2016 & August 2010\\
    \hline
    target price & \$35 & \$45 & \$174 & \$129 & \$120 & \$499\\
    \hline
    word size & 32-bit & 32-bit & 32-bit & 32-bit & 32-bit & 32-bit/64-bit \\
    \hline
    SoC & Broadcom BCM2836 & Texas Instruments AM3358/9 & Texas Instruments OMAP4430 & Freescale i.MX6 Quad & i.MX 6Ultra Light & Intel Atom\\
    \hline
    CPU & ARM Cortex-A7 & ARM Cortex-A8 & ARM Cortex-A9 & ARM Cortex-A9 & ARM Cortex-A7 & x86\\
    \hline
    frequency & 900 MHz & 1000 MHz & 1000 MHz & 1000 MHz & 528 MHz & 1800 MHz\\
    \hline
    RAM & 1 GB (shared with GPU) & 512 MiB DDR3 & 1 GB & 2GB DDR3 & 512MB SDRAM DDR3  & 2GB DDR3\\
    \hline
    Power source (consumption) & 5 V via Micro USB or GPIO header & Mini USB or 2.1 mm x 5.5 mm 5 V jack & 5V & 5V & 5V/micro USB & 19V? tiny connector?\\
    \hline
    USB & 4 (via the on-board 5-port USB hub) & USB 2.0 & two USB host ports and one USB On-The-Go & USB 2.0 & USB 2.0 & USB 2.0\\
    \hline
    Network & 10/100 Mbit/s Ethernet (8P8C) USB adapter on the USB hub & Ethernet Fast Ethernet (MII based) & 10/100 Ethernet on USB hub & GbE & 10/100 half duplex & 10/100 Ethernet\\
    \hline
    storage & MicroSDHC slot & 4GB eMMC / MicroSDHC slot & SDHC slot & MicroSDHC & 2GB
    eMMC & SATA (i.e. 500 GB HDD)\\
    \hline
  \end{tabular}
  \caption{Development boards comparison}
\end{table}
prices
nice big table

\section{Raspberry Pi 2 Model B}

\section{BeagleBone Black}

\section{PandaBoard}

- no serial response\\
- not visible in network\\
after power connection:\\
- LED's are blinking\\
- HDMI black screen\\
after stabilization\\
- LED's are blinking in another way\\
- Ethernet LED's are blinking\\
\\
drawbacks:\\
- poor support from community\\
- "big" SD card\\
- size: large surface + high audio and Ethernet/USB connectors\\
- Ethernet over USB\\
- serial db-9 connector\\
- strange USB type ab connector\\
- strange graphics solutions (two HDMI s)\\

\section{Wandboard Quad}

\section{Grinn liteboard}

\section{x86\_64 (Asus Eee PC 1215n)}

\chapter{Build systems}
\label{chapter:build systems}

history\\
package management\\
adding own software: packages, configuration\\

\section{Build system vs Linux distributions vs Distribution Creators}
There is much confusion in semantic layer here. Linux is just a operating system kernel, it is not providing any user space.
In the beginning, when Linux was created, there was no distributions, so if anybody want to utilize it, it had to be compiled and configured in a way later described in Linux From Scratch.
After some conceptual projects, the two still most important distributions were created: Debian and Red Hat which provides not only fully working solution, but also their own way to adding software - package management systems: deb and rpm. 

\section{Linux From Scratch}

\url{http://www.linuxfromscratch.org}\\
\url{http://trac.clfs.org}\\
\url{http://intestinate.com/pilfs/}\\
\url{https://raspberrypi.stackexchange.com/questions/25/is-there-a-linux-from-scratch-lfs-arm-equivalent}

\section{Buildroot}

\section{OpenWrt / LEDE}

\section{Yocto Project / Open Embedded}

\section{LTIB}

\section{Pengutronix / PTXdist / barebox}

\chapter{Software}
\label{chapter:software}

\section{POSIX Test Suites}

\section{Node.js and IoT}

\section{CAN and CANopen}

\section{MIPI CSI and OpenCV}

\section{Xenomai}

meta-eldk/linux-xenomai
\url{https://layers.openembedded.org/layerindex/recipe/8333/}

\chapter{Methodology}
\label{chapter:methodology}

\section{Build servers}
minimal requirements vs maximum usable resources\\
1. local machine (laptop)\\
2. cloud server (payed m1.2 x large - count time on various sizes + cost + servery.pl vs Amazon AWS)\\
3. dedicated server (own... Intel Xeon)\\
4. dedicated server (payed)\\
count costs in comparison to... big mac / salary?

\subsection{OpenStack test procedure}

\begin{enumerate}
  \item Login to Horizon panel (https://horizon.serwery.pl)
  \item Select "instances" and "launch instance"
  \item Choose instance name (mgr-builder-X), type (m1.2xlarge), image (Debian 8.4)
  \item Choose or create key pair
  \item Launch instance
  \item Login with (\verb|ssh -i .ssh/host-keys.pem debian@host-ip|)
  \item Update system (\verb|sudo apt update && sudo apt upgrade|)
  \item Select "volumes" and "create volume"
  \item Choose volume name (mgr-volume-X), type (SAS), size (100 GB)
  \item Create volume
  \item Attach volume to instance
  \item Create partition on volume (\verb|sudo mkfs.ext4 /dev/sdb|)
  \item Mount volume (\verb|sudo mount /dev/sdb /mnt/|)
  \item (\verb|sudo chown debian:debian /mnt/|)
  \item Navigate to mounted directory (\verb|cd /mnt/|)
\end{enumerate}

\subsection{Buildroot procedure}

\paragraph{Avalible configs}

\begin{verbatim}
wandboard_defconfig                 - Build for wandboard
raspberrypi_defconfig               - Build for raspberrypi
raspberrypi2_defconfig              - Build for raspberrypi2
pandaboard_defconfig                - Build for pandaboard
grinn_liteboard_defconfig           - Build for grinn_liteboard
beaglebone_defconfig                - Build for beaglebone
beaglebone_qt5_defconfig            - Build for beaglebone_qt5
pc_x86_64_bios_defconfig            - Build for pc_x86_64_bios
pc_x86_64_efi_defconfig             - Build for pc_x86_64_efi
qemu_x86_64_defconfig               - Build for qemu_x86_64
qemu_x86_defconfig                  - Build for qemu_x86
\end{verbatim}

https://buildroot.org/downloads/buildroot-2017.02.4.tar.gz

\paragraph{Build procedure}

\begin{verbatim}
sudo apt install libncurses-dev (libdt4-dev?) unzip git make gcc g++
git clone --depth 1 git://git.busybox.net/buildroot
cd buildroot/
make X_defconfig
make
\end{verbatim}

\subsection{Yocto procedure}


\subsection{Deploy image}

\begin{itemize}
  \item \verb|scp|
  \item \verb!pv sdcard.img | dd of=/dev/sdb bs=4M oflag=dsync!
\end{itemize}

\section{Data storage}
WARNING: DEGRADATION OF SD CARDS! (ram file system... and other mechanisms)

\chapter{Conclusions}
\label{chapter:conclusions}

\addcontentsline{toc}{chapter}{Bibliography}
\bibliography{embedded-linux-build-systems}

\listoffigures
\listoftables

\end{document}
